<html>
    <head>
      <link href="https://fonts.googleapis.com/css?family=DM+Sans:700&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="/treat/main.css"></link>
      <title data-rh="" data-reactroot="">treat – Background</title><meta data-rh="" property="og:title" content="treat – Background" data-reactroot=""/><meta data-rh="" name="twitter:title" content="treat – Background" data-reactroot=""/>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="icon" type="image/png" sizes="16x16" href="https://seek-oss.github.io/treat/favicon-16x16.png" />
      <link rel="icon" type="image/png" sizes="32x32" href="https://seek-oss.github.io/treat/favicon-32x32.png" />
      <link rel="icon" type="image/png" sizes="96x96" href="https://seek-oss.github.io/treat/favicon-96x96.png" />
      <meta property="og:image" content="https://seek-oss.github.io/treat/og-image.png" />
      <meta property="og:image:width" content="1200">
      <meta property="og:image:height" content="600">
      <meta property="og:type" content="website">
      <meta property="og:site_name" content="treat">
      <meta name="twitter:card" content="summary_large_image">
      <meta name="twitter:image" content="https://seek-oss.github.io/treat/og-image.png" />
    </head>
    <body>
        <div id="app"><div class="_2J50C _22MYm"><div class="_24lIM _22MYm"></div><div class="_24lIM _22MYm"></div><div class="_24lIM _22MYm"></div></div><div class="_1LiiJ_5k _32mJ1 _22MYm"></div><div class="_3lzCJ_5k _3a3Ze _22MYm erp2D _2kAlk _2eJYG"><div class="_3hSgY_5k _22MYm TU1wE _3a3PS _3Pwif _2RJV4"><div class="_3gkhV _22MYm _33Bzv _3VdD- _2M2HN _3OkyS"><div class="_3yNI_"><div class="_22MYm _1s2s-"><a class="_2ylXP_5k _3jCXD_5k _1yaRf_5k" href="/treat/">Introduction</a></div><div class="_22MYm _2eJYG"><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/#requirements">Requirements</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/#basic-usage">Basic usage</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/#themed-usage">Themed usage</a></div></div><div class="_22MYm _1s2s-"><a aria-current="page" class="_2ylXP_5k _3jCXD_5k _1yaRf_5k _1aK93_5k" href="/treat/background">Background</a></div><div class="_22MYm _2eJYG"><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/background#tradeoffs">Tradeoffs</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/background#backstory">Backstory</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/background#thanks">Thanks</a></div></div><div class="_22MYm _1s2s-"><a class="_2ylXP_5k _3jCXD_5k _1yaRf_5k" href="/treat/how-it-works">How it works</a></div><div class="_22MYm _2eJYG"><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/how-it-works#static-extraction">Static extraction</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/how-it-works#theming">Theming</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/how-it-works#runtime">Runtime</a></div></div><div class="_22MYm _1s2s-"><a class="_2ylXP_5k _3jCXD_5k _1yaRf_5k" href="/treat/setup">Setup</a></div><div class="_22MYm _2eJYG"><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/setup#webpack-setup">Webpack Setup</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/setup#babel-setup">Babel Setup</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/setup#debugging">Debugging</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/setup#server-side-rendering">Server side rendering</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/setup#bundle-splitting">Bundle splitting</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/setup#gatsby-setup">Gatsby Setup</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/setup#nextjs-setup">Next.js Setup</a></div></div><div class="_22MYm _1s2s-"><a class="_2ylXP_5k _3jCXD_5k _1yaRf_5k" href="/treat/data-types">Data types</a></div><div class="_22MYm _2eJYG"><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/data-types#styles">Styles</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/data-types#themedstyles">ThemedStyles</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/data-types#theme">Theme</a></div></div><div class="_22MYm _1s2s-"><a class="_2ylXP_5k _3jCXD_5k _1yaRf_5k" href="/treat/styling-api">Styling API</a></div><div class="_22MYm _2eJYG"><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/styling-api#createtheme">createTheme</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/styling-api#style">style</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/styling-api#stylemap">styleMap</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/styling-api#styletree">styleTree</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/styling-api#globalstyle">globalStyle</a></div></div><div class="_22MYm _1s2s-"><a class="_2ylXP_5k _3jCXD_5k _1yaRf_5k" href="/treat/runtime-api">Runtime API</a></div><div class="_22MYm _2eJYG"><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/runtime-api#resolvestyles">resolveStyles</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/runtime-api#resolveclassname">resolveClassName</a></div></div><div class="_22MYm _1s2s-"><a class="_2ylXP_5k _3jCXD_5k _1yaRf_5k" href="/treat/react-api">React API</a></div><div class="_22MYm _2eJYG"><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/react-api#treatprovider">TreatProvider</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/react-api#usestyles">useStyles</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/react-api#useclassname">useClassName</a></div></div><div class="_22MYm _1s2s-"><a class="_2ylXP_5k _3jCXD_5k _1yaRf_5k" href="/treat/webpack-options">Webpack Options</a></div><div class="_22MYm _2eJYG"><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/webpack-options#outputloaders">outputLoaders</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/webpack-options#test">test</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/webpack-options#localidentname">localIdentName</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/webpack-options#themeidentname">themeIdentName</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/webpack-options#minify">minify</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/webpack-options#browsers">browsers</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/webpack-options#outputcss">outputCSS</a></div><div class="_2G8AG _22MYm _2M2HN"><a class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k" href="/treat/webpack-options#hmr">hmr</a></div></div><div class="_22MYm _1s2s-"><a class="_2ylXP_5k _3jCXD_5k _1yaRf_5k" href="/treat/https://www.github.com/seek-oss/treat">Community</a></div><div class="_22MYm _2eJYG"><div class="_2G8AG _22MYm _2M2HN"><a href="https://www.github.com/seek-oss/treat" class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k">GitHub</a></div><div class="_2G8AG _22MYm _2M2HN"><a href="https://spectrum.chat/treatcss" class="_1ionO QzvHS _3jCXD_5k _3-S3p_5k">Spectrum</a></div></div></div></div></div></div><div class="yktBz_5k"><div class="_3hSgY_5k _22MYm TU1wE _3a3PS _3Pwif _2RJV4"><div class="_22MYm _33Bzv _32zDg"><div class="_22MYm _2CVOp"><a href="/treat/"><img src="/treat/3c0f21185028de58e4e604ccdb668206.png" height="36" style="position:relative;left:-6px" alt="treat"/></a><div><div><div class="_22MYm _1aRNy _24Yy-"><h1 class="_1ez5e_5k _2mPRc_5k _1CTZ-_5k _1R3TZ_5k">Background</h1></div><a id="tradeoffs" class="_2FMJW"></a><a style="text-decoration:none" href="#tradeoffs"><h2 class="_1ez5e_5k _2mPRc_5k _1_liR_5k _3zlAh_5k">Tradeoffs</h2></a><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">There are plenty of great CSS-in-JS solutions available—and we’re big fans of them. However, treat has taken quite a different approach.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">The primary goals of treat are <strong>full static extraction, minimal runtime code, type safety and legacy browser support.</strong> While a great developer experience is important to us, it will never come at the cost of these goals.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">Unlike a lot of CSS-in-JS approaches, treat is much more similar to <a href="https://github.com/css-modules/css-modules" class="QzvHS _3jCXD_5k _1x7sZ_5k">CSS Modules</a>, requiring a bit more work to bind styles to your components. It’s also unable to generate styles at runtime, which means it cannot handle dynamic theming. The upside of treat is that it allows you to craft themeable, statically extracted CSS using JavaScript (or TypeScript) with little impact to bundle size and negligible runtime performance cost.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">If you’re used to libraries like <a href="https://www.styled-components.com" class="QzvHS _3jCXD_5k _1x7sZ_5k">styled-components</a> or <a href="https://emotion.sh/" class="QzvHS _3jCXD_5k _1x7sZ_5k">Emotion</a>, treat might seem like a step backwards. These libraries can quickly and easily create dynamic component-oriented styles. However, they come with a bundle size and performance cost. For plenty of applications, this is a worthwhile tradeoff—and these libraries are a great choice if this isn’t an issue for you.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">If you’re familiar with static CSS-in-JS libraries like <a href="https://linaria.now.sh/" class="QzvHS _3jCXD_5k _1x7sZ_5k">Linaria</a> and <a href="https://github.com/4Catalyzer/astroturf" class="QzvHS _3jCXD_5k _1x7sZ_5k">Astroturf</a>, treat is very similar but with a couple of notable differences. Firstly, treat’s theming mechanism doesn’t require CSS custom property support (i.e. CSS variables), which means that legacy browsers like IE11 are supported. Secondly, styles are written as objects rather than template literals, to both ensure type safety, and to encourage you to think of your styles as data rather than strings of CSS.</span></p><a id="backstory" class="_2FMJW"></a><a style="text-decoration:none" href="#backstory"><h2 class="_1ez5e_5k _2mPRc_5k _1_liR_5k _3zlAh_5k">Backstory</h2></a><div class="_37vj9_5k _22MYm _1MTw2 _2cdRf _1XTZB _2gdnY"><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">You don’t have to read this to understand treat, but it’ll give you a much better understanding of where we’re coming from.</span></p></div><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">The origins of treat begin with <a href="https://github.com/seek-oss/braid-design-system" class="QzvHS _3jCXD_5k _1x7sZ_5k">Braid</a>, our design system.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">Braid was originally built with CSS Modules, but authored in JavaScript (via <a href="https://github.com/naistran/css-in-js-loader" class="QzvHS _3jCXD_5k _1x7sZ_5k">css-in-js-loader</a>). Unfortunately, we were hitting up against the limits of this approach.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm"><strong>Problem #1: We were unable to author our CSS Modules in TypeScript.</strong></span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">When you attempt to write your CSS Modules in TypeScript, you export an entire style sheet object (which then gets converted to a CSS Module by <a href="https://github.com/postcss/postcss-js" class="QzvHS _3jCXD_5k _1x7sZ_5k">postcss-js</a>).</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">For example, let’s assume we have the following style sheet:</span></p><pre class="_22MYm _2eJYG"><div class="_1PNuj_5k _22MYm _1knNH Z1NYo"><div class="_22MYm _33Bzv _2kAlk _2eJYG _1QAel TU1wE _3a3PS _3Pwif _2RJV4"><div class="_3jCXD_5k _38YDH_5k _1-ZQ2_5k _3eq0n_5k _22MYm"><code class="_2teDl_5k _22MYm"><span class="language-jsx" data-language="jsx" data-highlighted-line-numbers=""><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token string">'.someClass'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    color<span class="token operator">:</span> <span class="token string">'red'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></div></div></div></pre><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">When importing this file, consumers can only see a flat <code class="_2teDl_5k _22MYm">styles</code> object, which is notably different to the object that was exported.</span></p><pre class="_22MYm _2eJYG"><div class="_1PNuj_5k _22MYm _1knNH Z1NYo"><div class="_22MYm _33Bzv _2kAlk _2eJYG _1QAel TU1wE _3a3PS _3Pwif _2RJV4"><div class="_3jCXD_5k _38YDH_5k _1-ZQ2_5k _3eq0n_5k _22MYm"><code class="_2teDl_5k _22MYm"><span class="language-jsx" data-language="jsx" data-highlighted-line-numbers=""><span class="token keyword">import</span> styles <span class="token keyword">from</span> <span class="token string">'./styles.css.js'</span><span class="token punctuation">;</span>

styles<span class="token punctuation">.</span>someClass<span class="token punctuation">;</span> <span class="token comment">// 'GENERATED_CLASS_NAME'</span>
</span></code></div></div></div></pre><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">The TypeScript compiler can’t make sense of this without an understanding of the transformation happening within webpack. When looking at the raw source code, this doesn’t make sense from a type perspective.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">As a result, even though the rest of our project was now written in TypeScript, we were forced to keep our CSS written in JavaScript. As a workaround, we generated TypeScript declaration files (via our own <a href="https://github.com/seek-oss/css-modules-typescript-loader" class="QzvHS _3jCXD_5k _1x7sZ_5k">css-modules-typescript-loader</a>), but it was less than ideal.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm"><strong>Problem #2: CSS Modules only provided a single flat namespace to work with.</strong></span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">We were generating themed collections of utility classes and wanted to export multiple namespaces from a single file, e.g. <code class="_2teDl_5k _22MYm">paddingTop</code>, <code class="_2teDl_5k _22MYm">background</code>, <code class="_2teDl_5k _22MYm">color</code>, etc.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">We were forced to manually namespace properties with underscores, which required a lot of boilerplate code to convert these into nested data structures (e.g. converting <code class="_2teDl_5k _22MYm">paddingTop_large</code> into <code class="_2teDl_5k _22MYm">paddingTop.large</code>).</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">TypeScript made this particularly painful because we also had to maintain type definitions for these extra translation steps.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm"><strong>Potential solution: Runtime CSS-in-JS?</strong></span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">At this point we talked about migrating to a runtime CSS-in-JS library like <a href="https://www.styled-components.com" class="QzvHS _3jCXD_5k _1x7sZ_5k">styled-components</a> or <a href="https://emotion.sh/" class="QzvHS _3jCXD_5k _1x7sZ_5k">Emotion</a>. In fact, if we were starting from scratch, it’s likely we would have simply reached for one of these libraries. That certainly would have solved our immediate problems.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">However, we weren’t starting from scratch. Instead, we were beginning to roll out our new design system to an existing, well-established ecosystem that had grown accustomed to the technical tradeoffs and runtime characteristics of CSS Modules.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">Some of our projects are particularly sensitive to changes in bundle size and runtime performance, and we didn’t want to negatively impact these projects from the outside. Some of our projects are even shipped as standalone JavaScript widgets into external codebases. We wanted to be sure that our new design system wouldn’t come with a noticeable change in footprint.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">We did leave the door open to adopting this architecture in the future, but decided that we wanted to see how far we could go with our current set of tradeoffs.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm"><strong>Potential solution: Static CSS-in-JS?</strong></span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">The next step for us was to investigate libraries like <a href="https://linaria.now.sh/" class="QzvHS _3jCXD_5k _1x7sZ_5k">Linaria</a> and <a href="https://github.com/4Catalyzer/astroturf" class="QzvHS _3jCXD_5k _1x7sZ_5k">Astroturf</a>, which are both really interesting attempts at getting the best of both worlds—CSS-in-JS without the runtime overhead.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">Unfortunately, neither of them quite fit our particular needs.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm"><a href="https://github.com/4Catalyzer/astroturf" class="QzvHS _3jCXD_5k _1x7sZ_5k">Astroturf</a> is a really lean solution to this problem, essentially supporting CSS Modules and standard preprocessors within JavaScript template literals. That makes it much more ergonomic than more traditional approaches, but it also inherits all of the limitations we were experiencing with CSS Modules.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm"><a href="https://linaria.now.sh/" class="QzvHS _3jCXD_5k _1x7sZ_5k">Linaria</a> looked a lot more promising due to its theming support, but it came with an important caveat. Theming is achieved via CSS custom properties (i.e. CSS variables), which means that legacy browsers like IE11 are not supported. This simply wasn’t an option for us.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm"><strong>Potential solution: Something new?</strong></span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">As a result, we started talking about alternative ideas. Something that could offer the theming ability of Linaria, but without the reliance on CSS variables. Something that could offer the runtime characteristics of CSS Modules, while feeling like regular JavaScript (or, in our case, TypeScript).</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">That’s when the early ideas for treat started to emerge.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">Early API designs looked promising, and initial prototypes proved that the concept could be supported by webpack. We decided to start investing in this approach—slowly at first, but ramping up as it started to further prove itself.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">We continued to refine treat over several months while we simultaneously worked on Braid, with the development of one supporting the other. The code in Braid was now much more maintainable than it was before, and treat ultimately shipped to production, supporting real applications, with only a couple of minor hiccups along the way.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm">After using treat internally for a considerable amount of time, we decided we were finally ready to share treat with the world—and here you are! 😎</span></p><a id="thanks" class="_2FMJW"></a><a style="text-decoration:none" href="#thanks"><h2 class="_1ez5e_5k _2mPRc_5k _1_liR_5k _3zlAh_5k">Thanks</h2></a><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm"><strong><a href="https://twitter.com/Jhnnns" class="QzvHS _3jCXD_5k _1x7sZ_5k">Johannes Ewald</a></strong> for letting us have the <code class="_2teDl_5k _22MYm">treat</code> name on npm.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm"><strong><a href="https://twitter.com/naistran" class="QzvHS _3jCXD_5k _1x7sZ_5k">Nathan Nam Tran</a></strong> for creating <a href="https://github.com/naistran/css-in-js-loader" class="QzvHS _3jCXD_5k _1x7sZ_5k">css-in-js-loader</a>, which served as the initial starting point for our approach.</span></p><p class="_22MYm N7Q-z"><span class="_3jCXD_5k _1x7sZ_5k _3SytU_5k _3eq0n_5k _3pqXu_5k _22MYm"><strong><a href="https://www.seek.com.au" class="QzvHS _3jCXD_5k _1x7sZ_5k">SEEK</a></strong> for giving us the space to do interesting work.</span></p></div><div style="float:left"><div class="_22MYm _1sdeb _2CVOp _16aHc PJujh _3Pi6G"><svg width="16" height="16" viewBox="0 0 1024 1024" class="_1died _11MMs"><path d="M945 266l78 67-510 524-510-524 75-69 435 451 432-449z"></path></svg><div class="_22MYm _16kxx _2iMK- _3Gsjd"><a class="QzvHS _3jCXD_5k _1x7sZ_5k" href="/treat/">Introduction</a></div></div></div><div style="float:right"><div class="_22MYm _1sdeb _2CVOp _16aHc PJujh _3Pi6G"><div class="_22MYm _16kxx _2iMK- _3Gsjd"><a class="QzvHS _3jCXD_5k _1x7sZ_5k" href="/treat/how-it-works">How it works</a></div><svg width="16" height="16" viewBox="0 0 1024 1024" class="_1died _1_Tsl"><path d="M945 266l78 67-510 524-510-524 75-69 435 451 432-449z"></path></svg></div></div></div></div></div></div></div></div>
        <script>window.BASE_URL = "/treat";</script>
        <script src="/treat/client.js"></script>
    </body>
  </html>